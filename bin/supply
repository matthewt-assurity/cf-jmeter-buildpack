#!/usr/bin/env bash
 
set -euo pipefail 

# https://docs.cloudfoundry.org/buildpacks/understand-buildpacks.html
BUILD_DIR="${1}"
CACHE_DIR="${2}"
DEPS_DIR="${3}"
DEPS_IDX="${4}"

BUILDPACK_DIR=$(dirname $(readlink -f ${BASH_SOURCE%/*}))
source ${BUILDPACK_DIR}/parameters.sh

if [ -f "${CACHE_DIR}"/"${JMETER_ARCHIVE}" ]
then
    echo "-----> Using JMeter from cache"
else
    echo "-----> Downloading JMeter"
    curl -fsSLO "${JMETER_URL}"
    tar -zxf "${JMETER_ARCHIVE}"
    mv "${JMETER_DIR}" "${CACHE_DIR}/${JMETER_DIR}"
fi
